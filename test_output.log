/home/lyx/semiff/third_party/mast3r/dust3r/dust3r/cloud_opt/base_opt.py:275: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
Testing MASt3R wrapper...
Looking for image at: /home/lyx/semiff/outputs/20260103_002526/images/00000.png
Image exists: True
Loading test image: /home/lyx/semiff/outputs/20260103_002526/images/00000.png
Image shape: (1920, 1080, 3)
Initializing MASt3R wrapper...
Warning, cannot find cuda-compiled version of RoPE2D, using a slow pytorch version instead
... loading model from /home/lyx/semiff/checkpoints/MASt3R_ViTLarge_BaseDecoder_512_catmlpdpt_metric.pth
instantiating : AsymmetricMASt3R(enc_depth=24, dec_depth=12, enc_embed_dim=1024, dec_embed_dim=768, enc_num_heads=16, dec_num_heads=12, pos_embed='RoPE100',img_size=(512, 512), head_type='catmlp+dpt', output_mode='pts3d+desc24', depth_mode=('exp', -inf, inf), conf_mode=('exp', 1, inf), patch_embed_cls='PatchEmbedDust3R', two_confs=True, desc_conf_mode=('exp', 0, inf), landscape_only=False)
Traceback (most recent call last):
  File "/home/lyx/semiff/test_mast3r.py", line 69, in <module>
    test_mast3r()
  File "/home/lyx/semiff/test_mast3r.py", line 43, in test_mast3r
    wrapper = MASt3RWrapper(device="cuda")
  File "/home/lyx/semiff/src/semiff/perception/mast3r_wrapper.py", line 60, in __init__
    self.model = self._load_model()
  File "/home/lyx/semiff/src/semiff/perception/mast3r_wrapper.py", line 85, in _load_model
    model = AsymmetricMASt3R.from_pretrained(str(model_path)).to(self.device)
  File "/home/lyx/semiff/third_party/mast3r/mast3r/model.py", line 49, in from_pretrained
    return load_model(pretrained_model_name_or_path, device='cpu')
  File "/home/lyx/semiff/third_party/mast3r/mast3r/model.py", line 32, in load_model
    net = eval(args)
  File "<string>", line 1, in <module>
  File "/home/lyx/semiff/third_party/mast3r/mast3r/model.py", line 44, in __init__
    super().__init__(**kwargs)
  File "/home/lyx/semiff/third_party/mast3r/dust3r/dust3r/model.py", line 69, in __init__
    super().__init__(**croco_kwargs)
  File "/home/lyx/semiff/third_party/mast3r/dust3r/croco/models/croco.py", line 84, in __init__
    self.initialize_weights()           
  File "/home/lyx/semiff/third_party/mast3r/dust3r/croco/models/croco.py", line 117, in initialize_weights
    self.apply(self._init_weights)
  File "/home/lyx/semiff/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1063, in apply
    module.apply(fn)
  File "/home/lyx/semiff/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1063, in apply
    module.apply(fn)
  File "/home/lyx/semiff/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1063, in apply
    module.apply(fn)
  [Previous line repeated 1 more time]
  File "/home/lyx/semiff/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1064, in apply
    fn(self)
  File "/home/lyx/semiff/third_party/mast3r/dust3r/croco/models/croco.py", line 122, in _init_weights
    torch.nn.init.xavier_uniform_(m.weight)
  File "/home/lyx/semiff/.venv/lib/python3.10/site-packages/torch/nn/init.py", line 467, in xavier_uniform_
    return _no_grad_uniform_(tensor, -a, a, generator)
  File "/home/lyx/semiff/.venv/lib/python3.10/site-packages/torch/nn/init.py", line 72, in _no_grad_uniform_
    return tensor.uniform_(a, b, generator=generator)
KeyboardInterrupt
